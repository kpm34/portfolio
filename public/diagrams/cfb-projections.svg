<svg width="1300" height="900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Inter, sans-serif; font-size: 24px; font-weight: 600; fill: #ffffff; }
      .subtitle { font-family: Inter, sans-serif; font-size: 14px; fill: #a0a0a0; }
      .section-title { font-family: Inter, sans-serif; font-size: 16px; font-weight: 600; fill: #ffffff; }
      .label { font-family: Inter, sans-serif; font-size: 13px; font-weight: 500; fill: #e5e5e5; }
      .sub-label { font-family: Inter, sans-serif; font-size: 11px; fill: #a0a0a0; }
      .tech-label { font-family: monospace; font-size: 10px; fill: #9ca3af; }
      .code { font-family: monospace; font-size: 10px; fill: #60a5fa; }
      .box { fill: rgba(255, 255, 255, 0.05); stroke: rgba(255, 255, 255, 0.1); stroke-width: 1; rx: 8; }
      .box-blue { fill: rgba(59, 130, 246, 0.1); stroke: rgba(59, 130, 246, 0.3); stroke-width: 1.5; rx: 8; }
      .box-green { fill: rgba(34, 197, 94, 0.1); stroke: rgba(34, 197, 94, 0.3); stroke-width: 1.5; rx: 8; }
      .box-purple { fill: rgba(168, 85, 247, 0.1); stroke: rgba(168, 85, 247, 0.3); stroke-width: 1.5; rx: 8; }
      .box-orange { fill: rgba(249, 115, 22, 0.1); stroke: rgba(249, 115, 22, 0.3); stroke-width: 1.5; rx: 8; }
      .box-cyan { fill: rgba(6, 182, 212, 0.1); stroke: rgba(6, 182, 212, 0.3); stroke-width: 1.5; rx: 8; }
      .arrow { stroke: #3b82f6; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-green { stroke: #22c55e; stroke-width: 2; fill: none; marker-end: url(#arrowhead-green); }
      .arrow-orange { stroke: #f97316; stroke-width: 2; fill: none; marker-end: url(#arrowhead-orange); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#3b82f6" />
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#22c55e" />
    </marker>
    <marker id="arrowhead-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#f97316" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1300" height="900" fill="#030303"/>

  <!-- Title -->
  <text x="650" y="40" text-anchor="middle" class="title">Projections Pipeline</text>
  <text x="650" y="65" text-anchor="middle" class="subtitle">Data Ingestion, Stats Processing, and Fantasy Scoring</text>

  <!-- External Data Sources -->
  <g id="sources">
    <text x="100" y="110" class="section-title">External Data Sources</text>

    <rect x="50" y="130" width="180" height="120" class="box-blue"/>
    <text x="140" y="160" text-anchor="middle" class="label">CFBD API</text>
    <text x="70" y="185" class="tech-label">collegefootballdata.com</text>
    <text x="70" y="205" class="tech-label">Game stats</text>
    <text x="70" y="220" class="tech-label">Player metadata</text>
    <text x="70" y="235" class="tech-label">Team rosters</text>

    <rect x="260" y="130" width="180" height="120" class="box-purple"/>
    <text x="350" y="160" text-anchor="middle" class="label">Betting APIs</text>
    <text x="280" y="185" class="tech-label">Lines and spreads</text>
    <text x="280" y="205" class="tech-label">Over/under totals</text>
    <text x="280" y="220" class="tech-label">Prop bets</text>
    <text x="280" y="235" class="tech-label">Live odds</text>

    <rect x="470" y="130" width="180" height="120" class="box-orange"/>
    <text x="560" y="160" text-anchor="middle" class="label">Proprietary Data</text>
    <text x="490" y="185" class="tech-label">EA College ratings</text>
    <text x="490" y="205" class="tech-label">Weather index</text>
    <text x="490" y="220" class="tech-label">Injury reports</text>
    <text x="490" y="235" class="tech-label">Depth charts</text>
  </g>

  <!-- CFB Data Client -->
  <g id="client">
    <text x="750" y="110" class="section-title">CFBDataClient</text>

    <rect x="700" y="130" width="350" height="120" class="box-green"/>
    <text x="875" y="160" text-anchor="middle" class="label">src/lib/cfb-data/client.ts</text>

    <text x="720" y="190" class="code">getGames(year, week, seasonType)</text>
    <text x="720" y="210" class="code">getPlayerStats(year, week, gameId?)</text>
    <text x="720" y="230" class="code">getTeamRoster(team, year)</text>
    <text x="720" y="250" class="code">getPlayerSeasonStats(year, team?)</text>
  </g>

  <!-- Arrows to client -->
  <line x1="230" y1="190" x2="260" y2="190" class="arrow"/>
  <line x1="440" y1="190" x2="470" y2="190" class="arrow"/>
  <line x1="650" y1="190" x2="700" y2="190" class="arrow"/>

  <!-- API Routes -->
  <g id="api">
    <text x="1100" y="110" class="section-title">API Routes</text>

    <rect x="1080" y="130" width="180" height="120" class="box"/>
    <text x="1170" y="160" text-anchor="middle" class="label">Stats Endpoints</text>
    <text x="1100" y="185" class="code">POST /api/stats/sync</text>
    <text x="1100" y="205" class="tech-label">Sync from CFBD</text>
    <text x="1100" y="225" class="code">GET /stats/weekly/[week]</text>
    <text x="1100" y="245" class="tech-label">Weekly stats</text>
  </g>

  <!-- Arrow to API -->
  <line x1="1050" y1="190" x2="1080" y2="190" class="arrow"/>

  <!-- Database Tables -->
  <g id="database">
    <text x="100" y="310" class="section-title">Supabase Database Tables</text>

    <rect x="50" y="330" width="600" height="180" class="box-blue"/>

    <!-- Players -->
    <rect x="70" y="350" width="170" height="140" class="box"/>
    <text x="155" y="375" text-anchor="middle" class="sub-label">players</text>
    <text x="90" y="395" class="tech-label">id, full_name</text>
    <text x="90" y="410" class="tech-label">position, nfl_team</text>
    <text x="90" y="425" class="tech-label">jersey_number</text>
    <text x="90" y="440" class="tech-label">headshot_url</text>
    <text x="90" y="455" class="tech-label">is_active, status</text>
    <text x="90" y="475" class="tech-label">cfbd_id (external)</text>

    <!-- Player Stats -->
    <rect x="260" y="350" width="180" height="140" class="box"/>
    <text x="350" y="375" text-anchor="middle" class="sub-label">player_stats (weekly)</text>
    <text x="280" y="395" class="tech-label">player_id, season_year</text>
    <text x="280" y="410" class="tech-label">week, game_id</text>
    <text x="280" y="425" class="tech-label">pass/rush/rec yards</text>
    <text x="280" y="440" class="tech-label">TDs, fumbles, ints</text>
    <text x="280" y="455" class="tech-label">fantasy_points_standard</text>
    <text x="280" y="475" class="tech-label">fantasy_points_ppr</text>

    <!-- Season Stats -->
    <rect x="460" y="350" width="170" height="140" class="box"/>
    <text x="545" y="375" text-anchor="middle" class="sub-label">player_season_stats</text>
    <text x="480" y="395" class="tech-label">player_id, season</text>
    <text x="480" y="410" class="tech-label">games_played</text>
    <text x="480" y="425" class="tech-label">total_yards</text>
    <text x="480" y="440" class="tech-label">total_tds</text>
    <text x="480" y="455" class="tech-label">avg_fantasy_pts</text>
    <text x="480" y="475" class="tech-label">career_high_week</text>
  </g>

  <!-- Fantasy Scoring Calculator -->
  <g id="calculator">
    <text x="720" y="310" class="section-title">Fantasy Scoring Calculator</text>

    <rect x="680" y="330" width="580" height="180" class="box-green"/>
    <text x="970" y="360" text-anchor="middle" class="label">src/lib/fantasy-scoring/calculate.ts</text>

    <text x="700" y="390" class="code">calculateFantasyPoints(stats: PlayerStats, settings: ScoringSettings): number</text>

    <!-- Passing -->
    <rect x="700" y="405" width="130" height="85" class="box"/>
    <text x="765" y="425" text-anchor="middle" class="sub-label">Passing</text>
    <text x="720" y="445" class="tech-label">yards x 0.04</text>
    <text x="720" y="460" class="tech-label">TD x 4</text>
    <text x="720" y="475" class="tech-label">INT x -2</text>

    <!-- Rushing -->
    <rect x="850" y="405" width="130" height="85" class="box"/>
    <text x="915" y="425" text-anchor="middle" class="sub-label">Rushing</text>
    <text x="870" y="445" class="tech-label">yards x 0.1</text>
    <text x="870" y="460" class="tech-label">TD x 6</text>
    <text x="870" y="475" class="tech-label">fumble x -2</text>

    <!-- Receiving -->
    <rect x="1000" y="405" width="130" height="85" class="box"/>
    <text x="1065" y="425" text-anchor="middle" class="sub-label">Receiving</text>
    <text x="1020" y="445" class="tech-label">rec x 1 (PPR)</text>
    <text x="1020" y="460" class="tech-label">yards x 0.1</text>
    <text x="1020" y="475" class="tech-label">TD x 6</text>

    <!-- Kicking/DST -->
    <rect x="1150" y="405" width="90" height="85" class="box"/>
    <text x="1195" y="425" text-anchor="middle" class="sub-label">K/DST</text>
    <text x="1170" y="445" class="tech-label">FG pts</text>
    <text x="1170" y="460" class="tech-label">Sacks</text>
    <text x="1170" y="475" class="tech-label">TDs</text>
  </g>

  <!-- Arrows -->
  <line x1="350" y1="330" x2="680" y2="380" class="arrow-green"/>

  <!-- Scoring Settings -->
  <g id="settings">
    <text x="100" y="560" class="section-title">League Scoring Settings</text>

    <rect x="50" y="580" width="400" height="180" class="box-purple"/>
    <text x="250" y="610" text-anchor="middle" class="label">league_settings table (per league)</text>

    <rect x="70" y="630" width="170" height="110" class="box"/>
    <text x="155" y="655" text-anchor="middle" class="sub-label">Scoring Type</text>
    <text x="90" y="680" class="tech-label">standard: rec x 0</text>
    <text x="90" y="695" class="tech-label">ppr: rec x 1</text>
    <text x="90" y="710" class="tech-label">half_ppr: rec x 0.5</text>
    <text x="90" y="725" class="tech-label">custom: user-defined</text>

    <rect x="260" y="630" width="170" height="110" class="box"/>
    <text x="345" y="655" text-anchor="middle" class="sub-label">Custom Multipliers</text>
    <text x="280" y="680" class="tech-label">pass_yards_per_point</text>
    <text x="280" y="695" class="tech-label">rush_td_points</text>
    <text x="280" y="710" class="tech-label">rec_td_points</text>
    <text x="280" y="725" class="tech-label">dst_sack_points</text>
  </g>

  <!-- Projection Engine (Planned) -->
  <g id="projections">
    <text x="520" y="560" class="section-title">Projection Engine (Planned)</text>

    <rect x="480" y="580" width="380" height="180" class="box-orange" style="stroke-dasharray: 5,5;"/>
    <text x="670" y="610" text-anchor="middle" class="label">Future: getProjectedPoints()</text>

    <rect x="500" y="630" width="160" height="110" class="box"/>
    <text x="580" y="655" text-anchor="middle" class="sub-label">Inputs</text>
    <text x="520" y="680" class="tech-label">Historical stats</text>
    <text x="520" y="695" class="tech-label">Opponent strength</text>
    <text x="520" y="710" class="tech-label">Weather data</text>
    <text x="520" y="725" class="tech-label">Injury status</text>

    <rect x="680" y="630" width="160" height="110" class="box"/>
    <text x="760" y="655" text-anchor="middle" class="sub-label">Outputs</text>
    <text x="700" y="680" class="tech-label">Projected points</text>
    <text x="700" y="695" class="tech-label">Confidence level</text>
    <text x="700" y="710" class="tech-label">Floor/ceiling</text>
    <text x="700" y="725" class="tech-label">Boom/bust %</text>
  </g>

  <!-- Usage -->
  <g id="usage">
    <text x="920" y="560" class="section-title">Where Scoring Is Used</text>

    <rect x="890" y="580" width="370" height="180" class="box-cyan"/>

    <rect x="910" y="600" width="160" height="70" class="box"/>
    <text x="990" y="625" text-anchor="middle" class="sub-label">Weekly Matchups</text>
    <text x="930" y="650" class="tech-label">team_weekly_scores</text>
    <text x="930" y="665" class="tech-label">Win/loss determination</text>

    <rect x="1090" y="600" width="150" height="70" class="box"/>
    <text x="1165" y="625" text-anchor="middle" class="sub-label">Draft Autopick</text>
    <text x="1110" y="650" class="tech-label">Rank by projected</text>
    <text x="1110" y="665" class="tech-label">Position priority</text>

    <rect x="910" y="685" width="160" height="55" class="box"/>
    <text x="990" y="710" text-anchor="middle" class="sub-label">Standings</text>
    <text x="930" y="730" class="tech-label">Points for/against</text>

    <rect x="1090" y="685" width="150" height="55" class="box"/>
    <text x="1165" y="710" text-anchor="middle" class="sub-label">Trade Analysis</text>
    <text x="1110" y="730" class="tech-label">Value comparison</text>
  </g>

  <!-- Data Flow -->
  <g id="flow">
    <text x="100" y="810" class="section-title">Data Flow Summary</text>

    <rect x="50" y="830" width="1200" height="50" class="box"/>

    <text x="120" y="860" text-anchor="middle" class="sub-label">CFBD API</text>
    <line x1="180" y1="855" x2="230" y2="855" class="arrow"/>

    <text x="300" y="860" text-anchor="middle" class="sub-label">CFBDataClient</text>
    <line x1="370" y1="855" x2="420" y2="855" class="arrow"/>

    <text x="500" y="860" text-anchor="middle" class="sub-label">player_stats</text>
    <line x1="580" y1="855" x2="630" y2="855" class="arrow-green"/>

    <text x="730" y="860" text-anchor="middle" class="sub-label">calculateFantasyPoints()</text>
    <line x1="850" y1="855" x2="900" y2="855" class="arrow-green"/>

    <text x="980" y="860" text-anchor="middle" class="sub-label">fantasy_points_*</text>
    <line x1="1060" y1="855" x2="1110" y2="855" class="arrow-orange"/>

    <text x="1180" y="860" text-anchor="middle" class="sub-label">UI Display</text>
  </g>

</svg>
